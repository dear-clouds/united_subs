var jq=jQuery;var bp_ajax_request=null;var newest_activities="";var activity_last_recorded=0;jq(document).ready(function(){if("-1"===window.location.search.indexOf("new")&&jq("div.forums").length){jq("#new-topic-post").hide()}else{jq("#new-topic-post").show()}bp_init_activity();var e=["members","groups","blogs","forums","group_members"],c=jq("#whats-new");bp_init_objects(e);if(c.length&&bp_get_querystring("r")){var a=c.val();jq("#whats-new-options").animate({height:"40px"});c.animate({height:"70px"});jq.scrollTo(c,500,{offset:-125,easing:"swing"});jq(".rtmedia-container").css("height","auto");jq(".rtmedia-container").css("visibility","visible");c.val("").focus().val(a)}c.focus(function(){jq("#whats-new-options").animate({height:"40px"});jq("#whats-new-form textarea").animate({height:"70px"});jq("#aw-whats-new-submit").prop("disabled",false);jq(this).parent().addClass("active");jq("#whats-new-content").addClass("active");var g=jq("form#whats-new-form"),f=jq("#activity-all");if(g.hasClass("submitted")){g.removeClass("submitted")}if(f.length){if(!f.hasClass("selected")){jq("#activity-filter-select select").val("-1");f.children("a").trigger("click")}else{if("-1"!==jq("#activity-filter-select select").val()){jq("#activity-filter-select select").val("-1");jq("#activity-filter-select select").trigger("change")}}}jq(".rtmedia-container").css("height","auto");jq(".rtmedia-container").css("visibility","visible")});jq("#whats-new-form").on("focusout",function(g){var f=jq(this);setTimeout(function(){if(!f.find(":hover").length){if(""!==c.val()){return}jq("#whats-new-options").animate({height:"0px"});jq("form#whats-new-form textarea").animate({height:"50px"});jq("#aw-whats-new-submit").prop("disabled",true);jq("#whats-new-content").removeClass("active");c.parent().removeClass("active");jq(".rtmedia-container").css("height","auto");jq(".rtmedia-container").css("visibility","visible")}},0)});jq("#aw-whats-new-submit").on("click",function(){var h=0,g=jq(this),i=g.closest("form#whats-new-form"),f={},j;jq.each(i.serializeArray(),function(l,k){if("_"!==k.name.substr(0,1)&&"whats-new"!==k.name.substr(0,9)){if(!f[k.name]){f[k.name]=k.value}else{if(!jq.isArray(f[k.name])){f[k.name]=new Array(f[k.name],k.value)}else{f[k.name].push(k.value)}}}});i.find("*").each(function(){if(jq.nodeName(this,"textarea")||jq.nodeName(this,"input")){jq(this).prop("disabled",true)}});jq("div.error").remove();g.addClass("loading");g.prop("disabled",true);i.addClass("submitted");object="";item_id=jq("#whats-new-post-in").val();content=jq("#whats-new").val();firstrow=jq("#buddypress ul.activity-list li").first();activity_row=firstrow;timestamp=null;if(firstrow.length){if(activity_row.hasClass("load-newest")){activity_row=firstrow.next()}timestamp=activity_row.prop("class").match(/date-recorded-([0-9]+)/)}if(timestamp){h=timestamp[1]}if(item_id>0){object=jq("#whats-new-post-object").val()}j=jq.extend({action:"post_update",cookie:bp_get_cookies(),_wpnonce_post_update:jq("#_wpnonce_post_update").val(),content:content,object:object,item_id:item_id,since:h,_bp_as_nonce:jq("#_bp_as_nonce").val()||""},f);jq.post(ajaxurl,j,function(n){i.find("*").each(function(){if(jq.nodeName(this,"textarea")||jq.nodeName(this,"input")){jq(this).prop("disabled",false)}});if(n[0]+n[1]==="-1"){i.prepend(n.substr(2,n.length));jq("#"+i.attr("id")+" div.error").hide().fadeIn(200)}else{if(0===jq("ul.activity-list").length){jq("div.error").slideUp(100).remove();jq("#message").slideUp(100).remove();jq("div.activity").append('<ul id="activity-stream" class="activity-list item-list">')}if(firstrow.hasClass("load-newest")){firstrow.remove()}jq("#activity-stream").prepend(n);jq("body").trigger("bpActivityLoaded");if(!h){jq("#activity-stream li:first").addClass("new-update just-posted")}if(0!==jq("#latest-update").length){var k=jq("#activity-stream li.new-update .activity-content .activity-inner p").html(),m=jq("#activity-stream li.new-update .activity-content .activity-header p a.view").attr("href"),p=jq("#activity-stream li.new-update .activity-content .activity-inner p").text(),o="";if(p!==""){o=k+" "}o+='<a href="'+m+'" rel="nofollow">'+BP_DTheme.view+"</a>";jq("#latest-update").slideUp(300,function(){jq("#latest-update").html(o);jq("#latest-update").slideDown(300)})}jq("li.new-update").hide().slideDown(300);jq("li.new-update").removeClass("new-update");jq("#whats-new").val("");i.get(0).reset();newest_activities="";activity_last_recorded=0}jq("#whats-new-options").animate({height:"0px"});jq("#whats-new-form textarea").animate({height:"50px"});jq("#aw-whats-new-submit").prop("disabled",true).removeClass("loading");jq("#whats-new-content").removeClass("active")});jq(".rtmedia-container").css("height","auto");jq(".rtmedia-container").css("visibility","visible");return false});jq("div.activity-type-tabs").on("click",function(h){var i=jq(h.target).parent(),g,f;if(h.target.nodeName==="STRONG"||h.target.nodeName==="SPAN"){i=i.parent()}else{if(h.target.nodeName!=="A"){return false}}jq.cookie("bp-activity-oldestpage",1,{path:"/"});g=i.attr("id").substr(9,i.attr("id").length);f=jq("#activity-filter-select select").val();if(g==="mentions"){jq("#"+i.attr("id")+" a strong").remove()}bp_activity_request(g,f);return false});jq("#activity-filter-select select").change(function(){var h=jq("div.activity-type-tabs li.selected"),g=jq(this).val(),f;if(!h.length){f=null}else{f=h.attr("id").substr(9,h.attr("id").length)}bp_activity_request(f,g);return false});jq("div.activity").on("click",function(f){var l=jq(f.target),n,o,m,p,g,i,j,k,q,h;if(l.hasClass("fav")||l.hasClass("unfav")){n=l.hasClass("fav")?"fav":"unfav";o=l.closest(".activity-item");m=o.attr("id").substr(9,o.attr("id").length);l.addClass("loading");jq.post(ajaxurl,{action:"activity_mark_"+n,cookie:bp_get_cookies(),id:m},function(r){l.removeClass("loading");l.fadeOut(200,function(){jq(this).html(r);jq(this).attr("title","fav"===n?BP_DTheme.remove_fav:BP_DTheme.mark_as_fav);jq(this).fadeIn(200)});if("fav"===n){if(!jq(".item-list-tabs #activity-favs-personal-li").length){if(!jq(".item-list-tabs #activity-favorites").length){jq(".item-list-tabs ul #activity-mentions").before('<li id="activity-favorites"><a href="#">'+BP_DTheme.my_favs+" <span>0</span></a></li>")}jq(".item-list-tabs ul #activity-favorites span").html(Number(jq(".item-list-tabs ul #activity-favorites span").html())+1)}l.removeClass("fav");l.addClass("unfav")}else{l.removeClass("unfav");l.addClass("fav");jq(".item-list-tabs ul #activity-favorites span").html(Number(jq(".item-list-tabs ul #activity-favorites span").html())-1);if(!Number(jq(".item-list-tabs ul #activity-favorites span").html())){if(jq(".item-list-tabs ul #activity-favorites").hasClass("selected")){bp_activity_request(null,null)}jq(".item-list-tabs ul #activity-favorites").remove()}}if("activity-favorites"===jq(".item-list-tabs li.selected").attr("id")){l.closest(".activity-item").slideUp(100)}});return false}if(l.hasClass("delete-activity")){p=l.parents("div.activity ul li");g=p.attr("id").substr(9,p.attr("id").length);i=l.attr("href");j=i.split("_wpnonce=");k=p.prop("class").match(/date-recorded-([0-9]+)/);j=j[1];l.addClass("loading");jq.post(ajaxurl,{action:"delete_activity",cookie:bp_get_cookies(),id:g,_wpnonce:j},function(r){if(r[0]+r[1]==="-1"){p.prepend(r.substr(2,r.length));p.children("#message").hide().fadeIn(300)}else{p.slideUp(300);if(k&&activity_last_recorded===k[1]){newest_activities="";activity_last_recorded=0}}});return false}if(l.hasClass("spam-activity")){p=l.parents("div.activity ul li");k=p.prop("class").match(/date-recorded-([0-9]+)/);l.addClass("loading");jq.post(ajaxurl,{action:"bp_spam_activity",cookie:encodeURIComponent(document.cookie),id:p.attr("id").substr(9,p.attr("id").length),_wpnonce:l.attr("href").split("_wpnonce=")[1]},function(r){if(r[0]+r[1]==="-1"){p.prepend(r.substr(2,r.length));p.children("#message").hide().fadeIn(300)}else{p.slideUp(300);if(k&&activity_last_recorded===k[1]){newest_activities="";activity_last_recorded=0}}});return false}if(l.parent().hasClass("load-more")){if(bp_ajax_request){bp_ajax_request.abort()}jq("#buddypress li.load-more").addClass("loading");if(null===jq.cookie("bp-activity-oldestpage")){jq.cookie("bp-activity-oldestpage",1,{path:"/"})}q=(jq.cookie("bp-activity-oldestpage")*1)+1;h=[];jq(".activity-list li.just-posted").each(function(){h.push(jq(this).attr("id").replace("activity-",""))});load_more_args={action:"activity_get_older_updates",cookie:bp_get_cookies(),page:q,exclude_just_posted:h.join(",")};load_more_search=bp_get_querystring("s");if(load_more_search){load_more_args.search_terms=load_more_search}bp_ajax_request=jq.post(ajaxurl,load_more_args,function(r){jq("#buddypress li.load-more").removeClass("loading");jq.cookie("bp-activity-oldestpage",q,{path:"/"});jq("#buddypress ul.activity-list").append(r.contents);jq("body").trigger("bpActivityLoaded");l.parent().hide()},"json");return false}if(l.parent().hasClass("load-newest")){f.preventDefault();l.parent().hide();activity_html=jq.parseHTML(newest_activities);jq.each(activity_html,function(r,s){if("LI"===s.nodeName&&jq(s).hasClass("just-posted")){if(jq("#"+jq(s).attr("id")).length){jq("#"+jq(s).attr("id")).remove()}}});jq("#buddypress ul.activity-list").prepend(newest_activities);newest_activities=""}});jq("div.activity").on("click",".activity-read-more a",function(h){var k=jq(h.target),j=k.parent().attr("id").split("-"),l=j[3],g=j[0],f,i;f=g==="acomment"?"acomment-content":"activity-inner";i=jq("#"+g+"-"+l+" ."+f+":first");jq(k).addClass("loading");jq.post(ajaxurl,{action:"get_single_activity_content",activity_id:l},function(m){jq(i).slideUp(300).html(m).slideDown(300)});return false});jq("form.ac-form").hide();if(jq(".activity-comments").length){bp_legacy_theme_hide_comments()}jq("div.activity").on("click",function(r){var x=jq(r.target),p,q,o,u,h,i,s,l,n,f,w,v,m,g,j,k,t;if(x.hasClass("acomment-reply")||x.parent().hasClass("acomment-reply")){if(x.parent().hasClass("acomment-reply")){x=x.parent()}p=x.attr("id");q=p.split("-");o=q[2];u=x.attr("href").substr(10,x.attr("href").length);h=jq("#ac-form-"+o);h.css("display","none");h.removeClass("root");jq(".ac-form").hide();h.children("div").each(function(){if(jq(this).hasClass("error")){jq(this).hide()}});if(q[1]!=="comment"){jq("#acomment-"+u).append(h)}else{jq("#activity-"+o+" .activity-comments").append(h)}if(h.parent().hasClass("activity-comments")){h.addClass("root")}h.slideDown(200);jq.scrollTo(h,500,{offset:-100,easing:"swing"});jq("#ac-form-"+q[2]+" textarea").focus();return false}if(x.attr("name")==="ac_form_submit"){h=x.parents("form");i=h.parent();s=h.attr("id").split("-");if(!i.hasClass("activity-comments")){l=i.attr("id").split("-");n=l[1]}else{n=s[2]}content=jq("#"+h.attr("id")+" textarea");jq("#"+h.attr("id")+" div.error").hide();x.addClass("loading").prop("disabled",true);content.addClass("loading").prop("disabled",true);w={action:"new_activity_comment",cookie:bp_get_cookies(),_wpnonce_new_activity_comment:jq("#_wpnonce_new_activity_comment").val(),comment_id:n,form_id:s[2],content:content.val()};v=jq("#_bp_as_nonce_"+n).val();if(v){w["_bp_as_nonce_"+n]=v}jq.post(ajaxurl,w,function(y){x.removeClass("loading");content.removeClass("loading");if(y[0]+y[1]==="-1"){h.append(jq(y.substr(2,y.length)).hide().fadeIn(200))}else{var z=h.parent();h.fadeOut(200,function(){if(0===z.children("ul").length){if(z.hasClass("activity-comments")){z.prepend("<ul></ul>")}else{z.append("<ul></ul>")}}var A=jq.trim(y);z.children("ul").append(jq(A).hide().fadeIn(200));h.children("textarea").val("");z.parent().addClass("has-comments")});jq("#"+h.attr("id")+" textarea").val("");jq("#activity-"+s[2]+" a.acomment-reply span").html(Number(jq("#activity-"+s[2]+" a.acomment-reply span").html())+1);m=z.find(".show-all").find("a");if(m){g=jq("li#activity-"+s[2]+" a.acomment-reply span").html();m.html(BP_DTheme.show_x_comments.replace("%d",g))}}jq(x).prop("disabled",false);jq(content).prop("disabled",false)});return false}if(x.hasClass("acomment-delete")){j=x.attr("href");k=x.parent().parent();h=k.parents("div.activity-comments").children("form");t=j.split("_wpnonce=");t=t[1];n=j.split("cid=");n=n[1].split("&");n=n[0];x.addClass("loading");jq(".activity-comments ul .error").remove();k.parents(".activity-comments").append(h);jq.post(ajaxurl,{action:"delete_activity_comment",cookie:bp_get_cookies(),_wpnonce:t,id:n},function(z){if(z[0]+z[1]==="-1"){k.prepend(jq(z.substr(2,z.length)).hide().fadeIn(200))}else{var B=jq("#"+k.attr("id")+" ul").children("li"),y=0,C,A,D;jq(B).each(function(){if(!jq(this).is(":hidden")){y++}});k.fadeOut(200,function(){k.remove()});C=jq("#"+k.parents("#activity-stream > li").attr("id")+" a.acomment-reply span");A=C.html()-(1+y);C.html(A);D=k.siblings(".show-all").find("a");if(D){D.html(BP_DTheme.show_x_comments.replace("%d",A))}if(0===A){jq(k.parents("#activity-stream > li")).removeClass("has-comments")}}});return false}if(x.hasClass("spam-activity-comment")){j=x.attr("href");k=x.parent().parent();x.addClass("loading");jq(".activity-comments ul div.error").remove();k.parents(".activity-comments").append(k.parents(".activity-comments").children("form"));jq.post(ajaxurl,{action:"bp_spam_activity_comment",cookie:encodeURIComponent(document.cookie),_wpnonce:j.split("_wpnonce=")[1],id:j.split("cid=")[1].split("&")[0]},function(z){if(z[0]+z[1]==="-1"){k.prepend(jq(z.substr(2,z.length)).hide().fadeIn(200))}else{var A=jq("#"+k.attr("id")+" ul").children("li"),y=0,B;jq(A).each(function(){if(!jq(this).is(":hidden")){y++}});k.fadeOut(200);B=k.parents("#activity-stream > li");jq("#"+B.attr("id")+" a.acomment-reply span").html(jq("#"+B.attr("id")+" a.acomment-reply span").html()-(1+y))}});return false}if(x.parent().hasClass("show-all")){x.parent().addClass("loading");setTimeout(function(){x.parent().parent().children("li").fadeIn(200,function(){x.parent().remove()})},600);return false}if(x.hasClass("ac-reply-cancel")){jq(x).closest(".ac-form").slideUp(200);return false}});jq(document).keydown(function(g){g=g||window.event;if(g.target){element=g.target}else{if(g.srcElement){element=g.srcElement}}if(element.nodeType===3){element=element.parentNode}if(g.ctrlKey===true||g.altKey===true||g.metaKey===true){return}var f=(g.keyCode)?g.keyCode:g.which;if(f===27){if(element.tagName==="TEXTAREA"){if(jq(element).hasClass("ac-input")){jq(element).parent().parent().parent().slideUp(200)}}}});jq(".dir-search, .groups-members-search").on("click",function(h){if(jq(this).hasClass("no-ajax")){return}var i=jq(h.target),j,f,g;if(i.attr("type")==="submit"){j=jq(".item-list-tabs li.selected").attr("id").split("-");f=j[0];g=null;if(h.currentTarget.className==="groups-members-search"){f="group_members";g="groups/single/members"}bp_filter_request(f,jq.cookie("bp-"+f+"-filter"),jq.cookie("bp-"+f+"-scope"),"div."+f,i.parent().children("label").children("input").val(),1,jq.cookie("bp-"+f+"-extras"),null,g);return false}});jq("div.item-list-tabs").on("click",function(j){if(jq(this).hasClass("no-ajax")||jq(j.target).hasClass("no-ajax")){return}var l=(j.target.nodeName==="SPAN")?j.target.parentNode:j.target,k=jq(l).parent(),m,g,i,h,f;if("LI"===k[0].nodeName&&!k.hasClass("last")){m=k.attr("id").split("-");g=m[0];if("activity"===g){return false}i=m[1];h=jq("#"+g+"-order-select select").val();f=jq("#"+g+"_search").val();bp_filter_request(g,h,i,"div."+g,f,1,jq.cookie("bp-"+g+"-extras"));return false}});jq("li.filter select").change(function(){var l,m,g,k,j,f,i,h;if(jq(".item-list-tabs li.selected").length){l=jq(".item-list-tabs li.selected")}else{l=jq(this)}m=l.attr("id").split("-");g=m[0];k=m[1];j=jq(this).val();f=false;i=null;if(jq(".dir-search input").length){f=jq(".dir-search input").val()}h=jq(".groups-members-search input");if(h.length){f=h.val();g="members";k="groups"}if("members"===g&&"groups"===k){g="group_members";i="groups/single/members"}if("friends"===g){g="members"}bp_filter_request(g,j,k,"div."+g,f,1,jq.cookie("bp-"+g+"-extras"),null,i);return false});jq("#buddypress").on("click",function(f){var n=jq(f.target),i,h,j,o,l,q,m,p,k,g;if(n.hasClass("button")){return true}if(n.parent().parent().hasClass("pagination")&&!n.parent().parent().hasClass("no-ajax")){if(n.hasClass("dots")||n.hasClass("current")){return false}if(jq(".item-list-tabs li.selected").length){i=jq(".item-list-tabs li.selected")}else{i=jq("li.filter select")}h=i.attr("id").split("-");j=h[0];o=false;l=jq(n).closest(".pagination-links").attr("id");q=null;m=n.attr("href").split("&");p=m[0].split("=");p=p[1];if(jq("div.dir-search input").length){o=jq(".dir-search input").val();if(!o&&bp_get_querystring("s")){o=jq(".dir-search input").prop("placeholder")}}k=jq(".groups-members-search input");if(k.length){o=k.val();j="members"}if("members"===j&&"groups"===h[1]){j="group_members";q="groups/single/members"}if("admin"===j&&jq("body").hasClass("membership-requests")){j="requests"}if(l.indexOf("pag-bottom")!==-1){g="pag-bottom"}else{g=null}bp_filter_request(j,jq.cookie("bp-"+j+"-filter"),jq.cookie("bp-"+j+"-scope"),"div."+j,o,p,jq.cookie("bp-"+j+"-extras"),g,q);return false}});jq("a.show-hide-new").on("click",function(){if(!jq("#new-topic-post").length){return false}if(jq("#new-topic-post").is(":visible")){jq("#new-topic-post").slideUp(200)}else{jq("#new-topic-post").slideDown(200,function(){jq("#topic_title").focus()})}return false});jq("#submit_topic_cancel").on("click",function(){if(!jq("#new-topic-post").length){return false}jq("#new-topic-post").slideUp(200);return false});jq("#forum-directory-tags a").on("click",function(){bp_filter_request("forums","tags",jq.cookie("bp-forums-scope"),"div.forums",jq(this).html().replace(/&nbsp;/g,"-"),1,jq.cookie("bp-forums-extras"));return false});jq("#send-invite-form").on("click","#invite-list input",function(){var g=jq("#send-invite-form > .invite").length,h,f;jq(".ajax-loader").toggle();if(g){jq(this).parents("ul").find("input").prop("disabled",true)}h=jq(this).val();if(jq(this).prop("checked")===true){f="invite"}else{f="uninvite"}if(!g){jq(".item-list-tabs li.selected").addClass("loading")}jq.post(ajaxurl,{action:"groups_invite_user",friend_action:f,cookie:bp_get_cookies(),_wpnonce:jq("#_wpnonce_invite_uninvite_user").val(),friend_id:h,group_id:jq("#group_id").val()},function(i){if(jq("#message")){jq("#message").hide()}if(g){bp_filter_request("invite","bp-invite-filter","bp-invite-scope","div.invite",false,1,"","","")}else{jq(".ajax-loader").toggle();if(f==="invite"){jq("#friend-list").append(i)}else{if(f==="uninvite"){jq("#friend-list li#uid-"+h).remove()}}jq(".item-list-tabs li.selected").removeClass("loading")}})});jq("#send-invite-form").on("click","a.remove",function(){var f=jq("#send-invite-form > .invite").length,g=jq(this).attr("id");jq(".ajax-loader").toggle();g=g.split("-");g=g[1];jq.post(ajaxurl,{action:"groups_invite_user",friend_action:"uninvite",cookie:bp_get_cookies(),_wpnonce:jq("#_wpnonce_invite_uninvite_user").val(),friend_id:g,group_id:jq("#group_id").val()},function(h){if(f){bp_filter_request("invite","bp-invite-filter","bp-invite-scope","div.invite",false,1,"","","")}else{jq(".ajax-loader").toggle();jq("#friend-list #uid-"+g).remove();jq("#invite-list #f-"+g).prop("checked",false)}});return false});jq(".visibility-toggle-link").on("click",function(f){f.preventDefault();jq(this).parent().hide().addClass("field-visibility-settings-hide").siblings(".field-visibility-settings").show().addClass("field-visibility-settings-open")});jq(".field-visibility-settings-close").on("click",function(h){h.preventDefault();var g=jq(this).parent(),f=g.find("input:checked").parent().text();g.hide().removeClass("field-visibility-settings-open").siblings(".field-visibility-settings-toggle").children(".current-visibility-level").text(f).end().show().removeClass("field-visibility-settings-hide")});jq("#profile-edit-form input:not(:submit), #profile-edit-form textarea, #profile-edit-form select, #signup_form input:not(:submit), #signup_form textarea, #signup_form select").change(function(){var f=true;jq("#profile-edit-form input:submit, #signup_form input:submit").on("click",function(){f=false});window.onbeforeunload=function(g){if(f){return BP_DTheme.unsaved_changes}}});jq("#friend-list a.accept, #friend-list a.reject").on("click",function(){var h=jq(this),f=jq(this).parents("#friend-list li"),g=jq(this).parents("li div.action"),l=f.attr("id").substr(11,f.attr("id").length),j=h.attr("href"),i=j.split("_wpnonce=")[1],k;if(jq(this).hasClass("accepted")||jq(this).hasClass("rejected")){return false}if(jq(this).hasClass("accept")){k="accept_friendship";g.children("a.reject").css("visibility","hidden")}else{k="reject_friendship";g.children("a.accept").css("visibility","hidden")}h.addClass("loading");jq.post(ajaxurl,{action:k,cookie:bp_get_cookies(),id:l,_wpnonce:i},function(m){h.removeClass("loading");if(m[0]+m[1]==="-1"){f.prepend(m.substr(2,m.length));f.children("#message").hide().fadeIn(200)}else{h.fadeOut(100,function(){if(jq(this).hasClass("accept")){g.children("a.reject").hide();jq(this).html(BP_DTheme.accepted).contents().unwrap()}else{g.children("a.accept").hide();jq(this).html(BP_DTheme.rejected).contents().unwrap()}})}});return false});jq("#members-dir-list, #members-group-list, #item-header").on("click",".friendship-button a",function(){jq(this).parent().addClass("loading");var h=jq(this).attr("id"),g=jq(this).attr("href"),f=jq(this);h=h.split("-");h=h[1];g=g.split("?_wpnonce=");g=g[1].split("&");g=g[0];jq.post(ajaxurl,{action:"addremove_friend",cookie:bp_get_cookies(),fid:h,_wpnonce:g},function(i){var j=f.attr("rel");parentdiv=f.parent();if(j==="add"){jq(parentdiv).fadeOut(200,function(){parentdiv.removeClass("add_friend");parentdiv.removeClass("loading");parentdiv.addClass("pending_friend");parentdiv.fadeIn(200).html(i)})}else{if(j==="remove"){jq(parentdiv).fadeOut(200,function(){parentdiv.removeClass("remove_friend");parentdiv.removeClass("loading");parentdiv.addClass("add");parentdiv.fadeIn(200).html(i)})}}});return false});jq("#buddypress").on("click",".group-button .leave-group",function(){if(false===confirm(BP_DTheme.leave_group_confirm)){return false}});jq("#groups-dir-list").on("click",".group-button a",function(){var h=jq(this).parent().attr("id"),g=jq(this).attr("href"),f=jq(this);h=h.split("-");h=h[1];g=g.split("?_wpnonce=");g=g[1].split("&");g=g[0];if(f.hasClass("leave-group")&&false===confirm(BP_DTheme.leave_group_confirm)){return false}jq.post(ajaxurl,{action:"joinleave_group",cookie:bp_get_cookies(),gid:h,_wpnonce:g},function(j){var i=f.parent();if(!jq("body.directory").length){window.location.reload()}else{jq(i).fadeOut(200,function(){i.fadeIn(200).html(j);var k=jq("#groups-personal span"),l=1;if(f.hasClass("leave-group")){if(i.hasClass("hidden")){i.closest("li").slideUp(200)}l=0}else{if(f.hasClass("request-membership")){l=false}}if(k.length&&l!==false){if(l){k.text((k.text()>>0)+1)}else{k.text((k.text()>>0)-1)}}})}});return false});jq("#buddypress").on("click",".pending",function(){return false});if(jq("body").hasClass("register")){var b=jq("#signup_with_blog");if(!b.prop("checked")){jq("#blog-details").toggle()}b.change(function(){jq("#blog-details").toggle()})}jq(".message-search").on("click",function(g){if(jq(this).hasClass("no-ajax")){return}var h=jq(g.target),f;if(h.attr("type")==="submit"||h.attr("type")==="button"){f="messages";bp_filter_request(f,jq.cookie("bp-"+f+"-filter"),jq.cookie("bp-"+f+"-scope"),"div."+f,jq("#messages_search").val(),1,jq.cookie("bp-"+f+"-extras"));return false}});jq("#send_reply_button").click(function(){var f=jq("#messages_order").val()||"ASC",h=jq("#message-recipients").offset(),g=jq("#send_reply_button");jq(g).addClass("loading");jq.post(ajaxurl,{action:"messages_send_reply",cookie:bp_get_cookies(),_wpnonce:jq("#send_message_nonce").val(),content:jq("#message_content").val(),send_to:jq("#send_to").val(),subject:jq("#subject").val(),thread_id:jq("#thread_id").val()},function(i){if(i[0]+i[1]==="-1"){jq("#send-reply").prepend(i.substr(2,i.length))}else{jq("#send-reply #message").remove();jq("#message_content").val("");if("ASC"===f){jq("#send-reply").before(i)}else{jq("#message-recipients").after(i);jq(window).scrollTop(h.top)}jq(".new-message").hide().slideDown(200,function(){jq(".new-message").removeClass("new-message")})}jq(g).removeClass("loading")});return false});jq("#mark_as_read, #mark_as_unread").click(function(){var o="",l=jq('#message-threads li .mark-item input[type="checkbox"]'),h,m,i,k,f,g,n,j;if("mark_as_unread"===jq(this).attr("id")){h="read";m="unread";i=1;k=0;f="inline";g="messages_markunread"}else{h="unread";m="read";i=0;k=1;f="none";g="messages_markread"}l.each(function(p){if(jq(this).is(":checked")){if(jq("#m-"+jq(this).attr("value")).hasClass(h)){o+=jq(this).attr("value");jq("#m-"+jq(this).attr("value")).removeClass(h);jq("#m-"+jq(this).attr("value")).addClass(m);var q=jq("#m-"+jq(this).attr("value")+" .thread-count span.unread-count").html();jq("#m-"+jq(this).attr("value")+" .thread-count span.unread-count").html(i);jq("#m-"+jq(this).attr("value")+" .thread-count span.unread-count").css("display",f);n=jq("li.unread").length;jq("#user-messages span").html(n);if(p!==l.length-1){o+=","}}}});jq.post(ajaxurl,{action:g,thread_ids:o});return false});jq("body.messages #item-body div.messages").on("change","#message-type-select",function(){var g=this.value,h=jq('li input[type="checkbox"]'),f="checked";h.each(function(j){h[j].checked=""});switch(g){case"unread":h=jq('li.unread input[type="checkbox"]');break;case"read":h=jq('li.read input[type="checkbox"]');break;case"":f="";break}h.each(function(j){h[j].checked=f})});jq("body.messages #item-body div.messages").on("click",".messages-options-nav a",function(){if(-1===jq.inArray(this.id,Array("delete_sentbox_messages","delete_inbox_messages"))){return}checkboxes_tosend="";checkboxes=jq('#message-threads li input[type="checkbox"]');jq("#message").remove();jq(this).addClass("loading");jq(checkboxes).each(function(f){if(jq(this).is(":checked")){checkboxes_tosend+=jq(this).attr("value")+","}});if(""===checkboxes_tosend){jq(this).removeClass("loading");return false}jq.post(ajaxurl,{action:"messages_delete",thread_ids:checkboxes_tosend},function(f){if(f[0]+f[1]==="-1"){jq("#message-threads").prepend(f.substr(2,f.length))}else{jq("#message-threads").before('<div id="message" class="updated"><p>'+f+"</p></div>");jq(checkboxes).each(function(g){if(jq(this).is(":checked")){jq(this).attr("checked",false);jq(this).parent().parent().fadeOut(150)}})}jq("#message").hide().slideDown(150);jq("#delete_inbox_messages, #delete_sentbox_messages").removeClass("loading")});return false});jq("#select-all-messages").click(function(f){if(this.checked){jq(".message-check").each(function(){this.checked=true})}else{jq(".message-check").each(function(){this.checked=false})}});jq("#messages-bulk-manage").attr("disabled","disabled");jq("#messages-select").on("change",function(){jq("#messages-bulk-manage").attr("disabled",jq(this).val().length<=0)});starAction=function(){var f=jq(this);jq.post(ajaxurl,{action:"messages_star",message_id:f.data("message-id"),star_status:f.data("star-status"),nonce:f.data("star-nonce"),bulk:f.data("star-bulk")},function(g){if(1===parseInt(g,10)){if("unstar"===f.data("star-status")){f.data("star-status","star");f.removeClass("message-action-unstar").addClass("message-action-star");f.find(".bp-screen-reader-text").text(BP_PM_Star.strings.text_star);if(1===BP_PM_Star.is_single_thread){f.prop("title",BP_PM_Star.strings.title_star)}else{f.prop("title",BP_PM_Star.strings.title_star_thread)}}else{f.data("star-status","unstar");f.removeClass("message-action-star").addClass("message-action-unstar");f.find(".bp-screen-reader-text").text(BP_PM_Star.strings.text_unstar);if(1===BP_PM_Star.is_single_thread){f.prop("title",BP_PM_Star.strings.title_unstar)}else{f.prop("title",BP_PM_Star.strings.title_unstar_thread)}}}});return false};jq("#message-threads").on("click",".thread-star a",starAction);jq("#message-thread").on("click",".message-star-actions a",starAction);jq("#message-threads .bulk-select-check :checkbox").on("change",function(){var f=jq(this),g=f.closest("li").find(".thread-star a");if(f.prop("checked")){if("unstar"===g.data("star-status")){BP_PM_Star.star_counter++}else{BP_PM_Star.unstar_counter++}}else{if("unstar"===g.data("star-status")){BP_PM_Star.star_counter--}else{BP_PM_Star.unstar_counter--}}if(BP_PM_Star.star_counter>0&&parseInt(BP_PM_Star.unstar_counter,10)===0){jq('option[value="star"]').hide()}else{jq('option[value="star"]').show()}if(BP_PM_Star.unstar_counter>0&&parseInt(BP_PM_Star.star_counter,10)===0){jq('option[value="unstar"]').hide()}else{jq('option[value="unstar"]').show()}});jq("#select-all-notifications").click(function(f){if(this.checked){jq(".notification-check").each(function(){this.checked=true})}else{jq(".notification-check").each(function(){this.checked=false})}});jq("#notification-bulk-manage").attr("disabled","disabled");jq("#notification-select").on("change",function(){jq("#notification-bulk-manage").attr("disabled",jq(this).val().length<=0)});jq("#close-notice").on("click",function(){jq(this).addClass("loading");jq("#sidebar div.error").remove();jq.post(ajaxurl,{action:"messages_close_notice",notice_id:jq(".notice").attr("rel").substr(2,jq(".notice").attr("rel").length)},function(f){jq("#close-notice").removeClass("loading");if(f[0]+f[1]==="-1"){jq(".notice").prepend(f.substr(2,f.length));jq("#sidebar div.error").hide().fadeIn(200)}else{jq(".notice").slideUp(100)}});return false});jq("#wp-admin-bar ul.main-nav li, #nav li").mouseover(function(){jq(this).addClass("sfhover")});jq("#wp-admin-bar ul.main-nav li, #nav li").mouseout(function(){jq(this).removeClass("sfhover")});jq("#wp-admin-bar-logout, a.logout").on("click",function(){jq.removeCookie("bp-activity-scope",{path:"/"});jq.removeCookie("bp-activity-filter",{path:"/"});jq.removeCookie("bp-activity-oldestpage",{path:"/"});var f=["members","groups","blogs","forums"];jq(f).each(function(g){jq.removeCookie("bp-"+f[g]+"-scope",{path:"/"});jq.removeCookie("bp-"+f[g]+"-filter",{path:"/"});jq.removeCookie("bp-"+f[g]+"-extras",{path:"/"})})});if(jq("body").hasClass("no-js")){jq("body").attr("class",jq("body").attr("class").replace(/no-js/,"js"))}if(typeof wp!=="undefined"&&typeof wp.heartbeat!=="undefined"&&typeof BP_DTheme.pulse!=="undefined"){wp.heartbeat.interval(Number(BP_DTheme.pulse));jq.fn.extend({"heartbeat-send":function(){return this.bind("heartbeat-send.buddypress")}})}var d=0;jq(document).on("heartbeat-send.buddypress",function(g,f){d=0;if(jq("#buddypress ul.activity-list li").first().prop("id")){timestamp=jq("#buddypress ul.activity-list li").first().prop("class").match(/date-recorded-([0-9]+)/);if(timestamp){d=timestamp[1]}}if(0===activity_last_recorded||Number(d)>activity_last_recorded){activity_last_recorded=Number(d)}f.bp_activity_last_recorded=activity_last_recorded;last_recorded_search=bp_get_querystring("s");if(last_recorded_search){f.bp_activity_last_recorded_search_terms=last_recorded_search}});jq(document).on("heartbeat-tick",function(g,f){if(!f.bp_activity_newest_activities){return}newest_activities=f.bp_activity_newest_activities.activities+newest_activities;activity_last_recorded=Number(f.bp_activity_newest_activities.last_recorded);if(jq("#buddypress ul.activity-list li").first().hasClass("load-newest")){return}jq("#buddypress ul.activity-list").prepend('<li class="load-newest"><a href="#newest">'+BP_DTheme.newest+"</a></li>")});jq(".toggle-header").click(function(){if(jq("#item-header-content").is(":visible")){jq("#item-header-content").slideUp(400,function(){jq("body").addClass("bp-header-small");jq.cookie("bp-profile-header","small",{path:"/"})})}else{jq("#item-header-content").slideDown(400,function(){jq("body").removeClass("bp-header-small");jq.cookie("bp-profile-header",null,{path:"/"})})}})});function bp_init_activity(){jq.cookie("bp-activity-oldestpage",1,{path:"/"});if(undefined!==jq.cookie("bp-activity-filter")&&jq("#activity-filter-select").length){jq('#activity-filter-select select option[value="'+jq.cookie("bp-activity-filter")+'"]').prop("selected",true)}if(undefined!==jq.cookie("bp-activity-scope")&&jq(".activity-type-tabs").length){jq(".activity-type-tabs li").each(function(){jq(this).removeClass("selected")});jq("#activity-"+jq.cookie("bp-activity-scope")+", .item-list-tabs li.current").addClass("selected")}}function bp_init_objects(a){jq(a).each(function(b){if(undefined!==jq.cookie("bp-"+a[b]+"-filter")&&jq("#"+a[b]+"-order-select select").length){jq("#"+a[b]+'-order-select select option[value="'+jq.cookie("bp-"+a[b]+"-filter")+'"]').prop("selected",true)}if(undefined!==jq.cookie("bp-"+a[b]+"-scope")&&jq("div."+a[b]).length){jq(".item-list-tabs li").each(function(){jq(this).removeClass("selected")});jq("#"+a[b]+"-"+jq.cookie("bp-"+a[b]+"-scope")+", #object-nav li.current").addClass("selected")}})}function bp_filter_request(d,a,i,e,g,f,c,b,h){if("activity"===d){return false}if(null===i){i="all"}jq.cookie("bp-"+d+"-scope",i,{path:"/"});jq.cookie("bp-"+d+"-filter",a,{path:"/"});jq.cookie("bp-"+d+"-extras",c,{path:"/"});jq(".item-list-tabs li").each(function(){jq(this).removeClass("selected")});jq("#"+d+"-"+i+", #object-nav li.current").addClass("selected");jq(".item-list-tabs li.selected").addClass("loading");jq('.item-list-tabs select option[value="'+a+'"]').prop("selected",true);if("friends"===d||"group_members"===d){d="members"}if(bp_ajax_request){bp_ajax_request.abort()}bp_ajax_request=jq.post(ajaxurl,{action:d+"_filter",cookie:bp_get_cookies(),object:d,filter:a,search_terms:g,scope:i,page:f,extras:c,template:h},function(j){if(b==="pag-bottom"&&jq("#subnav").length){var k=jq("#subnav").parent();jq("html,body").animate({scrollTop:k.offset().top},"slow",function(){jq(e).fadeOut(100,function(){jq(this).html(j);jq(this).fadeIn(100,function(){jq("body").trigger("gridloaded")})})})}else{jq(e).fadeOut(100,function(){jq(this).html(j);jq(this).fadeIn(100,function(){jq("body").trigger("gridloaded")})})}jq(".item-list-tabs li.selected").removeClass("loading")})}function bp_activity_request(b,a){if(null!==b){jq.cookie("bp-activity-scope",b,{path:"/"})}if(null!==a){jq.cookie("bp-activity-filter",a,{path:"/"})}jq.cookie("bp-activity-oldestpage",1,{path:"/"});jq(".item-list-tabs li").each(function(){jq(this).removeClass("selected loading")});jq("#activity-"+b+", .item-list-tabs li.current").addClass("selected");jq("#object-nav.item-list-tabs li.selected, div.activity-type-tabs li.selected").addClass("loading");jq('#activity-filter-select select option[value="'+a+'"]').prop("selected",true);jq(".widget_bp_activity_widget h2 span.ajax-loader").show();if(bp_ajax_request){bp_ajax_request.abort()}bp_ajax_request=jq.post(ajaxurl,{action:"activity_widget_filter",cookie:bp_get_cookies(),_wpnonce_activity_filter:jq("#_wpnonce_activity_filter").val(),scope:b,filter:a},function(c){jq(".widget_bp_activity_widget h2 span.ajax-loader").hide();jq("#buddypress div.activity").fadeOut(100,function(){jq(this).html(c.contents);jq(this).fadeIn(100,function(){jq("body").trigger("bpActivityLoaded")});bp_legacy_theme_hide_comments()});if(undefined!==c.feed_url){jq(".directory #subnav li.feed a, .home-page #subnav li.feed a").attr("href",c.feed_url)}jq(".item-list-tabs li.selected").removeClass("loading")},"json")}function bp_legacy_theme_hide_comments(){var d=jq("div.activity-comments"),c,b,a;if(!d.length){return false}d.each(function(){if(jq(this).children("ul").children("li").length<5){return}comments_div=jq(this);c=comments_div.parents("#activity-stream > li");b=jq(this).children("ul").children("li");a=" ";if(jq("#"+c.attr("id")+" a.acomment-reply span").length){a=jq("#"+c.attr("id")+" a.acomment-reply span").html()}b.each(function(e){if(e<b.length-5){jq(this).toggle();if(!e){jq(this).before('<li class="show-all"><a href="#'+c.attr("id")+'/show-all/" title="'+BP_DTheme.show_all_comments+'">'+BP_DTheme.show_x_comments.replace("%d",a)+"</a></li>")}}})})}function checkAll(){var b=document.getElementsByTagName("input"),a;for(a=0;a<b.length;a++){if(b[a].type==="checkbox"){if($("check_all").checked===""){b[a].checked=""}else{b[a].checked="checked"}}}}function clear(a){a=document.getElementById(a);if(!a){return}var d=a.getElementsByTagName("INPUT"),b=a.getElementsByTagName("OPTION"),c=0;if(d){for(c=0;c<d.length;c++){d[c].checked=""}}if(b){for(c=0;c<b.length;c++){b[c].selected=false}}}function bp_get_cookies(){var c=document.cookie.split(";"),g={},a="bp-",f,e,b,d,h;for(f=0;f<c.length;f++){e=c[f];b=e.indexOf("=");d=jq.trim(unescape(e.slice(0,b)));h=unescape(e.slice(b+1));if(d.indexOf(a)===0){g[d]=h}}return encodeURIComponent(jq.param(g))};
/*! 
 * BuddyBoss Wall JavaScript Library 
 * @package BuddyBoss Wall 
 */function buddyboss_wall_initiate_privacy_form(a){if($link=$(a),0==jq("#form_buddyboss-wall-privacy").length){var b=$("#buddyboss-wall-form-wrapper-tpl").html();$form=jq(b).find("#form_buddyboss-wall-privacy")}else $form=jq("#form_buddyboss-wall-privacy");return $form_wrapper=$form.parent(),$link.closest(".activity").find("form.ac-form").slideUp(),$form_wrapper.is(":visible")?(buddyboss_wall_privacy_close(),!1):($(".buddyboss-activity-comments-form").hide(),$link.closest(".activity-content").after($form_wrapper),$selected_visibilty=$link.data("visibility"),$selected_visibilty_group=$link.hasClass("buddyboss-group-privacy-filter"),($selected_visibilty_group||"grouponly"!==$selected_visibilty)&&$selected_visibilty||($selected_visibilty="public"),$form.find("#bbwall-privacy-selectbox").val($selected_visibilty),$form_wrapper.slideDown(200),bbmedia_move_media_opened=!0,$form.find('input[name="activity_id"]').val($link.data("activity_id")),!1)}function buddyboss_wall_privacy_close(){return $form=$("#form_buddyboss-wall-privacy"),$form_wrapper=$form.parent(),$form_wrapper.slideUp(200),bbmedia_move_media_opened=!1,!1}function buddyboss_wall_submit_privacy(){if($form=$("#form_buddyboss-wall-privacy"),$form_wrapper=$form.parent(),$submit_button=$form.find('input[type="submit"]'),$animated_loader=$form.find(".privacy-filter-ajax-loader"),$submit_button.hasClass("loading"))return!1;$animated_loader.css("display","inline-block");var a={action:"buddyboss_wall_update_activity_privacy",bboss_wall_privacy_nonce:$form.find('input[name="bboss_wall_privacy_nonce"]').val(),activity_id:$form.find('input[name="activity_id"]').val(),buddyboss_activity_visibility:$form.find('select[name="bbwall-privacy-selectbox"]').val()};return $submit_button.addClass("loading"),$form.find("#message").removeAttr("class").html(""),$.ajax({type:"POST",url:ajaxurl,data:a,success:function(a){$curr_visibility=$form.find("#bbwall-privacy-selectbox").val(),$form_wrapper.closest(".activity").find(".buddyboss_privacy_filter").data("visibility",$curr_visibility),$animated_loader.hide(),a=$.parseJSON(a),a.status?($form.find("#message").addClass("updated").html("<p>"+a.message+"</p>"),setTimeout(function(){buddyboss_wall_privacy_cleanup($form,!1)},2e3)):$form.find("#message").addClass("error").html("<p>"+a.message+"</p>"),$submit_button.removeClass("loading")}}),!1}function buddyboss_wall_privacy_cleanup(a,b){a.find("#message").removeAttr("class").html(""),$form_wrapper=a.parent(),buddyboss_wall_privacy_close(),b&&($activity=a.closest(".activity"),$("body").append($form_wrapper),$form_wrapper.hide(),$activity.slideUp(200,function(){$activity.remove()}))}if("undefined"==typeof jq)var jq=jQuery;jq(document).ready(function(){jq("span#activity-visibility").prependTo("div#whats-new-submit"),jq("input#aw-whats-new-submit").off("click");var a=jq("select#whats-new-post-in").val();jq("select#whats-new-post-in").data("selected",a),"undefined"!=typeof visibility_levels&&void 0!=a&&0!=a&&jq("select#bbwall-activity-privacy").replaceWith(visibility_levels.groups),jq("select#whats-new-post-in").on("change",function(){var a=jq(this).data("selected"),b=jq("#whats-new-post-in").val();"undefined"!=typeof visibility_levels&&(0==b&&b!=a?jq("select#bbwall-activity-privacy").replaceWith(visibility_levels.profile):0!=b&&0==a&&jq("select#bbwall-activity-privacy").replaceWith(visibility_levels.groups)),jq("select#bbwall-activity-privacy").next().remove(),jq(this).data("selected",b)}),jq("input#aw-whats-new-submit").on("click",function(){var a=jq(this),b=a.parent().parent().parent().parent();b.children().each(function(){(jq.nodeName(this,"textarea")||jq.nodeName(this,"input"))&&jq(this).prop("disabled",!0)}),jq("div.error").remove(),a.addClass("loading"),a.prop("disabled",!0);var c="",d=jq("#whats-new-post-in").val(),e=jq("textarea#whats-new").val(),f=jq("select#bbwall-activity-privacy").val();if(d>0&&(c=jq("#whats-new-post-object").val()),"function"==typeof bp_get_cookies)var g=bp_get_cookies();else var g=encodeURIComponent(document.cookie);return jq.post(ajaxurl,{action:"post_update",cookie:g,_wpnonce_post_update:jq("input#_wpnonce_post_update").val(),content:e,visibility:f,object:c,item_id:d,_bp_as_nonce:jq("#_bp_as_nonce").val()||""},function(a){b.children().each(function(){(jq.nodeName(this,"textarea")||jq.nodeName(this,"input"))&&jq(this).prop("disabled",!1)}),a[0]+a[1]=="-1"?(b.prepend(a.substr(2,a.length)),jq("form#"+b.attr("id")+" div.error").hide().fadeIn(200)):(0==jq("ul.activity-list").length&&(jq("div.error").slideUp(100).remove(),jq("div#message").slideUp(100).remove(),jq("div.activity").append('<ul id="activity-stream" class="activity-list item-list">')),jq("ul#activity-stream").prepend(a),jq("ul#activity-stream li:first").addClass("new-update"),jq("li.new-update").hide().slideDown(300),jq("li.new-update").removeClass("new-update"),jq("textarea#whats-new").val("")),jq("#whats-new-options").animate({height:"0px"}),jq("form#whats-new-form textarea").animate({height:"20px"}),jq("#aw-whats-new-submit").prop("disabled",!0).removeClass("loading"),jq("select#bbwall-activity-privacy option[selected]").prop("selected",!0).trigger("change")}),!1})});